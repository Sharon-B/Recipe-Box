{% extends "base.html" %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col">
                <h2 class="page-heading">Edit Recipe</h2>
            </div>
        </div>
   
        <form id="add-recipe-form" method="POST" action="{{ url_for('edit_recipe', recipe_id=recipe._id)}}">
            <!-- Recipe Name -->
            <div class="row form-section">
                <div class="col-12">
                    <label for="recipe_name" class="form-label">Recipe Name:</label>
                </div>
                <div class="col-12 form-recipe-name form-input">
                    <input id="recipe_name" name="recipe_name" type="text" minlength="1" maxlength="45"
                        value="{{ recipe.recipe_name }}" class="add-recipe input-field validate" pattern="^[a-zA-Z0-9_][a-zA-Z0-9_ &]*[a-zA-Z0-9_]{1,45}$" required>
                </div>
            </div>
            <!-- Recipe Description -->
            <div class="row form-section">
                <div class="col-12">
                    <label for="recipe_description" class="form-label">Recipe Description:</label>
                </div>
                <div class="col-12 form-recipe-name form-input">
                    <textarea name="recipe_description" id="recipe_description" class="add-recipe input-field validate"
                        placeholder="Recipe description" minlength="5" maxlength="150" required>
                        {{- recipe.recipe_description }}
                    </textarea>
                </div>
            </div>
            <!-- Category Select -->
            <div class="row form-section">
                <div class="col-sm-12 col-md-3">
                    <label for="category_name" class="form-label">Select Category:</label>
                </div>
                <div class="col-sm-12 col-md-3 category-select form-input">
                    <select id="category_name" class="add-recipe input-field validate" name="category_name" form="add-recipe-form" required>
                        <option value="" class="disabled">Select Category:</option>
                        {% for category in categories %}
                            {% if category.category_name == recipe.category_name %}
                                <option value="{{ category.category_name }}" selected>{{ category.category_name }}</option>
                            {% else %}
                                <option value="{{ category.category_name }}">{{ category.category_name }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>
            </div>
                <!-- Prep Time -->
            <div class="row form-section">
                <div class="col-sm-6 col-md-3">
                    <label for="prep_time" class="form-label">Prep Time in mins:</label>
                </div>
                <div class="col-sm-6 col-md-3 form-prep form-input">
                    <input id="prep_time" name="prep_time" type="text" minlength="3" maxlength="10"
                        pattern="^[a-zA-Z0-9_][a-zA-Z0-9_ ]*[a-zA-Z0-9_]{3,10}$" class="add-recipe input-field validate" value="{{ recipe.prep_time }}" required>
                </div>
                <!-- Cook Time -->
                <div class="col-sm-6 col-md-3">
                    <label for="cook_time" class="form-label">Cook Time in mins:</label>
                </div>
                <div class="col-sm-6 col-md-3 form-prep form-input">
                    <input id="cook_time" name="cook_time" type="text" minlength="3" maxlength="10"
                        pattern="^[a-zA-Z0-9_][a-zA-Z0-9_ ]*[a-zA-Z0-9_]{3,10}$" class="add-recipe input-field validate" value="{{ recipe.cook_time }}" required>
                </div>
            </div>
            <!-- Ingredients -->
            <div class="row form-section">
                <div class="col-12">
                    <label for="ingredients" class="form-label">Ingredients (one per line):</label>
                </div>
                <div class="col-12 form-ingredients form-input">
                    <textarea name="ingredients" id="ingredients" class="add-recipe input-field ws-pw validate" rows="8" required>
                        {%- for ingredient in recipe.ingredients -%}{{ ingredient }}{%- endfor -%}
                    </textarea>
                </div>
            </div>

            <!-- Method -->
            <div class="row form-section">
                <div class="col-12">
                    <label for="method" class="form-label">Method:</label>
                </div>
                <div class="col-12 form-method form-input">
                    <textarea name="method" id="method" class="add-recipe input-field ws-pw validate" rows="12" required>
                        {%- for meth in recipe.method -%}{{ meth }}{%- endfor -%}
                    </textarea>
                </div>
            </div>
            <!-- Recipe Image URL -->
            <div class="row form-section">
                <div class="col-12">
                    <label for="recipe_url" class="form-label">Image URL:</label>
                </div>
                <div class="col-12 form-image-url form-input">
                    <input id="recipe_url" name="recipe_url" type="text" class="add-recipe input-field validate"
                        value="{{ recipe.recipe_url }}" required>
                </div>
            </div>
            <!-- Edit/Delete buttons -->
            <div class="buttons sub">
                <a href="{{ url_for('profile', username=session['user']) }}" class="btn delete-button button">Cancel</a>
                <input class="submit-button button" type="submit" value="Edit Recipe">  
            </div>
        </form>

    </div>
{% endblock %}